{"ast":null,"code":"import _defineProperty from\"F:\\\\lcomernbootcamp\\\\projfrontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"F:\\\\lcomernbootcamp\\\\projfrontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"F:\\\\lcomernbootcamp\\\\projfrontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import Base from\"../core/Base\";import{Redirect}from\"react-router-dom\";import{signin,authenticate,isAutheticated}from\"../auth/helper\";var Signin=function Signin(){var _useState=useState({email:\"\",password:\"\",error:\"\",loading:false,didRedirect:false}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var email=values.email,password=values.password,error=values.error,loading=values.loading,didRedirect=values.didRedirect;var _isAutheticated=isAutheticated(),user=_isAutheticated.user;var handleChange=function handleChange(name){return function(event){setValues(_objectSpread({},values,_defineProperty({error:false},name,event.target.value)));};};var onSubmit=function onSubmit(event){event.preventDefault();setValues(_objectSpread({},values,{error:false,loading:true}));signin({email:email,password:password}).then(function(data){if(data.error){setValues(_objectSpread({},values,{error:data.error,loading:false}));}else{authenticate(data,function(){setValues(_objectSpread({},values,{didRedirect:true}));});}}).catch(console.log(\"signin request failed\"));};var performRedirect=function performRedirect(){if(didRedirect){if(user&&user.role===1){return React.createElement(Redirect,{to:\"/admin/dashboard\"});}else{return React.createElement(Redirect,{to:\"/user/dashboard\"});}}if(isAutheticated()){return React.createElement(Redirect,{to:\"/\"});}};var loadingMessage=function loadingMessage(){return loading&&React.createElement(\"div\",{className:\"alert alert-info\"},React.createElement(\"h2\",null,\"Loading...\"));};var errorMessage=function errorMessage(){return React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col-md-6 offset-sm-3 text-left\"},React.createElement(\"div\",{className:\"alert alert-danger\",style:{display:error?\"\":\"none\"}},error)));};var signInForm=function signInForm(){return React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col-md-6 offset-sm-3 text-left\"},React.createElement(\"form\",null,React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{className:\"text-light\"},\"Email\"),React.createElement(\"input\",{onChange:handleChange(\"email\"),value:email,className:\"form-control\",type:\"email\"})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{className:\"text-light\"},\"Password\"),React.createElement(\"input\",{onChange:handleChange(\"password\"),value:password,className:\"form-control\",type:\"password\"})),React.createElement(\"button\",{onClick:onSubmit,className:\"btn btn-success btn-block\"},\"Submit\"))));};return React.createElement(Base,{title:\"Sign In page\",description:\"A page for user to sign in!\"},loadingMessage(),errorMessage(),signInForm(),performRedirect());};export default Signin;","map":{"version":3,"sources":["F:/lcomernbootcamp/projfrontend/src/user/Signin.js"],"names":["React","useState","Base","Redirect","signin","authenticate","isAutheticated","Signin","email","password","error","loading","didRedirect","values","setValues","user","handleChange","name","event","target","value","onSubmit","preventDefault","then","data","catch","console","log","performRedirect","role","loadingMessage","errorMessage","display","signInForm"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Base from \"../core/Base\";\nimport { Redirect } from \"react-router-dom\";\n\nimport { signin, authenticate, isAutheticated } from \"../auth/helper\";\n\nconst Signin = () => {\n  const [values, setValues] = useState({\n    email: \"\",\n    password: \"\",\n    error: \"\",\n    loading: false,\n    didRedirect: false\n  });\n\n  const { email, password, error, loading, didRedirect } = values;\n  const { user } = isAutheticated();\n\n  const handleChange = name => event => {\n    setValues({ ...values, error: false, [name]: event.target.value });\n  };\n\n  const onSubmit = event => {\n    event.preventDefault();\n    setValues({ ...values, error: false, loading: true });\n    signin({ email, password })\n      .then(data => {\n        if (data.error) {\n          setValues({ ...values, error: data.error, loading: false });\n        } else {\n          authenticate(data, () => {\n            setValues({\n              ...values,\n              didRedirect: true\n            });\n          });\n        }\n      })\n      .catch(console.log(\"signin request failed\"));\n  };\n\n  const performRedirect = () => {\n    if (didRedirect) {\n      if (user && user.role === 1) {\n        return <Redirect to=\"/admin/dashboard\" />;\n      } else {\n        return <Redirect to=\"/user/dashboard\" />;\n      }\n    }\n    if (isAutheticated()) {\n      return <Redirect to=\"/\" />;\n    }\n  };\n\n  const loadingMessage = () => {\n    return (\n      loading && (\n        <div className=\"alert alert-info\">\n          <h2>Loading...</h2>\n        </div>\n      )\n    );\n  };\n\n  const errorMessage = () => {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-6 offset-sm-3 text-left\">\n          <div\n            className=\"alert alert-danger\"\n            style={{ display: error ? \"\" : \"none\" }}\n          >\n            {error}\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  const signInForm = () => {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-6 offset-sm-3 text-left\">\n          <form>\n            <div className=\"form-group\">\n              <label className=\"text-light\">Email</label>\n              <input\n                onChange={handleChange(\"email\")}\n                value={email}\n                className=\"form-control\"\n                type=\"email\"\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"text-light\">Password</label>\n              <input\n                onChange={handleChange(\"password\")}\n                value={password}\n                className=\"form-control\"\n                type=\"password\"\n              />\n            </div>\n            <button onClick={onSubmit} className=\"btn btn-success btn-block\">\n              Submit\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <Base title=\"Sign In page\" description=\"A page for user to sign in!\">\n      {loadingMessage()}\n      {errorMessage()}\n      {signInForm()}\n      {performRedirect()}\n    </Base>\n  );\n};\n\nexport default Signin;\n"]},"metadata":{},"sourceType":"module"}